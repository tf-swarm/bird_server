var AssetAdapter=function(){function e(){}var t=(__define,e),r=t.prototype;return r.getAsset=function(e,t,r){function n(n){t.call(r,n,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?n(s):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(e){function t(){e.call(this),this.createView()}__extends(t,e);var r=(__define,t),n=r.prototype;return n.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=200,this.textField.width=640,this.textField.height=100,this.textField.textColor=8947848,this.textField.textAlign="center"},n.setProgress=function(e,t){this.textField.text="Loading..."},t}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(t,e);var r=(__define,t),n=r.prototype;return n.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},n.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},n.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},n.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},n.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},n.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},n.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},n.startCreateScene=function(){this.addChild(new SceneBegin)},t}(eui.UILayer);egret.registerClass(Main,"Main");var SceneBegin=function(e){function t(){e.call(this);var t=parseInt(window.I("userId")),r=window.I("session"),n=decodeURIComponent(window.I("httpGame")),s=n+"/v1/game/rank_list",i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open(s,egret.HttpMethod.POST),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var o={gameId:2,userId:t,session:r};i.send(JSON.stringify(o)),i.addEventListener(egret.Event.COMPLETE,this.buildChildren,this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this)}__extends(t,e);var r=(__define,t),n=r.prototype;return n.createChildren=function(){e.prototype.createChildren.call(this),this.skinName="skins.SceneBeginSkin",this.tabBar.addEventListener(eui.ItemTapEvent.ITEM_TAP,function(e){this.viewStack.selectedIndex=this.tabBar.selectedIndex},this)},n.buildChildren=function(t){e.prototype.createChildren.call(this);var r=t.currentTarget,n=JSON.parse(r.response),s=n.mine;s.gold=s.chip;var i=["gold","exp"],o=["chip","exp"],a=[new eui.ArrayCollection,new eui.ArrayCollection],d=[this.gold_list,this.exp_list];for(var c in[0,1]){var u=i[c],l=o[c],h=a[c],E=d[c],R=n[l],p=!1;for(var g in R)R[g]=JSON.parse(R[g]),R[g].uid==s.uid?(R[g]=s,p=!0):R[g][u]=R[g][l];p||R.push(s),R.sort(function(e,t){return t[u]-e[u]});var v=0;for(var g in R){var m=R[g],_=[];switch(++v){case 1:_.index_img="lv1_png";break;case 2:_.index_img="lv2_png";break;case 3:_.index_img="lv3_png";break;default:_.index_img="",_.rank=" "+v}m.vip>0&&(_.vip=" "+m.vip,_.vip_img="vip"+m.vip+"_png",_.vip_png="vip_png"),_.item_bg=v%2==0?"bar_2_png":"bar_1_png",_[u]=" "+m[u],_.nickname=m.nick,_.avatar="avatar_"+m.sex+"_png",_.level=this.get_level(m.exp),h.addItem(_)}E.dataProvider=h}},n.onIOError=function(e){console.log("get error : "+e)},n.get_level=function(e){switch(!0){case e>=5&&20>e:return"2";case e>=20&&50>e:return"3";case e>=50&&100>e:return"4";case e>=100&&200>e:return"5";case e>=200&&400>e:return"6";case e>=400&&800>e:return"7";case e>=800&&1600>e:return"8";case e>=1600&&3200>e:return"9";case e>=3200&&6400>e:return"10";case e>=6400&&12800>e:return"11";case e>=12800&&25600>e:return"12";case e>=25600&&51200>e:return"13";case e>=51200&&102400>e:return"14";case e>=102400&&2e5>e:return"15";case e>=2e5&&3e5>e:return"16";case e>=3e5&&4e5>e:return"17";case e>=4e5&&5e5>e:return"18";case e>=5e5&&6e5>e:return"19";case e>=6e5&&7e5>e:return"20";case e>=7e5&&8e5>e:return"21";case e>=8e5&&9e5>e:return"22";case e>=9e5&&1e6>e:return"23";case e>=1e6&&11e5>e:return"24";case e>=11e5&&12e5>e:return"25";case e>=12e5&&13e5>e:return"26";case e>=13e5&&14e5>e:return"27";case e>=14e5&&15e5>e:return"28";case e>=15e5&&16e5>e:return"29";case e>=16e5:return"30";default:return"1"}},t}(eui.Component);egret.registerClass(SceneBegin,"SceneBegin");var ThemeAdapter=function(){function e(){}var t=(__define,e),r=t.prototype;return r.getTheme=function(e,t,r,n){function s(e){t.call(n,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),r.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);